##
## Copyright 2021, Flyreel. All Rights Reserved.
##
## Licensed under the Apache License, Version 2.0 (the "License");
## you may not use this file except in compliance with the License.
## You may obtain a copy of the License at
##
##     http://www.apache.org/licenses/LICENSE-2.0
##
## Unless required by applicable law or agreed to in writing, software
## distributed under the License is distributed on an "AS IS" BASIS,
## WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
## See the License for the specific language governing permissions and
## limitations under the License.
## ========================================================================##
defaults:
  - supervised_base
learner:
  hparams:
    num_classes: 10
    model:
      backbone:
        _target_: sesemi.PyTorchImageModels
        name: resnet50d
        freeze: False
        pretrained: False
        global_pool: avg
        drop_rate: 0.5
      regularization_loss_heads:
        jigsaw_prediction:
          head:
            _target_: sesemi.models.heads.loss.JigsawPredictionLossHead
            input_data: unsupervised
            input_backbone: backbone
          scheduler:
            _target_: sesemi.schedulers.weight.SigmoidRampupScheduler
            weight: 1.0
            stop_rampup: 0
          scale_factor: 1.0
        entropy_minimization:
          head:
            _target_: sesemi.models.heads.loss.EntropyMinimizationLossHead
            input_data: unsupervised
            input_backbone: backbone
            predict_fn: supervised
          scheduler:
            _target_: sesemi.schedulers.weight.SigmoidRampupScheduler
            weight: 1.0
            stop_rampup: 0
          scale_factor: 1.0